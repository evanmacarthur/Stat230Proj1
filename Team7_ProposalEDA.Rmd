---
title: "STAT230 Work Team Project: Proposal & EDA"
author: "Work Team 7: Evan, Becca, Laith"
date: "due Thursday, October 12th"
output: 
  pdf_document:
    fig_height: 3
    fig_width: 5
---

```{r include=FALSE}
# Don't delete this chunk if you are using the mosaic package
# This loads the mosaic and mosaicData packages
library(mosaic)
library(car)
library(rjson)
library(jsonlite)
library(httr)
library(tidyverse)
library(glue)
library(purrr)
library(janitor)
library(rvest)
library(robotstxt)
library(hablar)
library(utils)
library(dplyr)
library(states)
library(tigris)
library(GGally)
library(readr)
```

```{r include=FALSE}
# Some customization.  You can alter or delete as desired (if you know what you are doing).
# knitr settings to control how R chunks work.
require(knitr)
opts_chunk$set(
  tidy=FALSE,     # display code as typed
  size="small"    # slightly smaller font for code
)
trellis.par.set(theme=theme.mosaic())  
options(digits=5)

theme_set(theme_bw())
```

[DELETE & DON'T INCLUDE the following instructions in your proposal]   

* Propose a proposal: The proposal part should include at least the following:  
    + Work Team number, all membersâ€™ names, and Work Team Project Title (if there is one).
    + Introduction & Motivation - What do you plan to study? What is the main (research) question of interest? WHY is this question interesting or important to your team?
    + Dataset - Where does it come from (including a citation of the data source)? What variables are you planning to use? Which is the response variable for your analysis?  
 
Since this is a warm-up project, I would recommend each work team to choose at least 4 variables but no more than 6 variables (including the response variable) from your dataset for the Work Team project.

* Perform an EDA (including graphs, numerical summaries, AND verbal descriptions) on the chosen variables that will be used in your modeling. Use appropriate graphical displays to justify that MLR is a reasonable choice for modeling (i.e. the CHOOSE step in 4-step modeling). You may find the document **Modeling in R: EDA** under *Useful Resources* particularly helpful for this deliverable.      
Additional Notes -   

This document should also include all the R code used to *wrangle* data, as well as those used to create the *EDA* output (plots, tables, numerical summaries, etc). Recall that you've learned various `R` functions for data wrangling back in **R Activity 2** (Part 3) and **R Activity 4** (Part 2), as well as from **R Tutorials** (under *Useful Resources*). Don't hesitate to ask for help from me or SDS fellows on this front.      

[--- DELETE until here: End of Instructions ---]


## Introduction & Motivation  

We are interested in how we can attempt to predict the profitability of farming by different farming practices. Specifically we are curious about sustainable agriculture decisions and decisions about crop types. From a conservationist perspective, it is important that sustainable choices are economically viable for farmers. 

https://www.nass.usda.gov/AgCensus/


Our data is sourced from the United States Census of Agriculture, between the years ______ and _____, along with county demographic information from Wikipedia, sourced from the U.S Census. 

Our response variable in reported farm income, and we are planning to predict it with a number of variables (pop_density, farm acres, bee colonies, grazing rotation, fertilizer use)


## Dataset & Wrangling   

On RStudio, be sure to save your dataset file in *the SAME folder* you saved this RMD file. I would strongly suggest that you create a specific folder on RStudio for this Project. When you wrangle your data, keep in mind that it's usually safer to save the mutated/filtered dataset as a *new* dataset.     

```{r}

```

```{r}
## wrangle!!  
df0 <- read_csv("gooddata.csv")
df0 <- df0 |> 
  clean_names()

df <- df0 |> 
  select(c(farm_income_1, fertilizer_use, grazing_rotation, bee_colonies, population, county_acreage_2000, farm_acres))

df1 <- df |> 
  mutate(pop_dens = population/county_acreage_2000)

```


## Exploratory Data Analysis (EDA)

Explore distributions and associations graphically and numerically.

```{r, message=FALSE}
ggpairs(df1, columns = 1:8, progress = FALSE)

ggplot(data = df1, aes(x = farm_income_1))+
  geom_histogram()
#looks like it could maybe use a transformation

```

```{r}
df2 <- df1 |> 
  mutate(farm_income_2 = log(farm_income_1+55152))

#we had one value that was very low because it was by far the smallest, even after we transposed the data. 
df2 <- df2 |> 
  filter(farm_income_2 > 5)
```

```{r, fig.height=6, fig.width=6}
ggpairs(df2, columns = 1:8, progress = FALSE)

ggplot(data = df2, aes(x = farm_income_2))+
  geom_histogram(bins = 30)

```
```{r}
df3 <- df2 |> 
  mutate(fertilizer_use_2 = sqrt(fertilizer_use))

gf_point(data = df3, farm_income_2 ~ fertilizer_use_2) |> 
  gf_lm()


```



```{r}
#df1 <- df |> 
#  mutate(age = cut(producer_age_group, breaks = c(-Inf,20,30,40,50,60,70,Inf))

lm1 <- lm(data = df1, farm_income_1 ~ pop_dens + age + farm_acres + bee_colonies + grazing_rotation + fertilizer_use)
msummary(lm1)
vif(lm1)
#looks good!
mplot(lm1, which = 1)
mplot(lm1, which = 2)
mplot(lm1, which = 3)
mplot(lm1, which = 5)


ggplot(data = df1, aes(x = farm_income_1))+
  geom_histogram()
```


```{r}


ggplot(data = df2, aes(x = farm_income_2))+
  geom_histogram(bins = 50)

lm2 <- lm(data = df2, farm_income_2 ~ pop_dens + farm_acres + bee_colonies + grazing_rotation + fertilizer_use)
msummary(lm2)

mplot(lm2, which = 1)
mplot(lm2, which = 2)
mplot(lm2, which = 3)
mplot(lm2, which = 5)



```
> These look much better


```{r probably not helpful but fun}
df3 <- df2[c(395,1026,1653),]

ggplot(data = df2, aes(x = bee_colonies, y = farm_income_2))+
  geom_point()+
  geom_point(data = df3, aes(x = bee_colonies, y = farm_income_2), color = "red")
```

```{r}

```





